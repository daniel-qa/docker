# Use a previous stage as a new stage

# syntax=docker/dockerfile:1
FROM debian:10 AS builder
RUN apt-get update -y && apt-get upgrade -y
RUN apt-get install nano -y
# start.sh
RUN echo "#!/bin/bash" >> /start.sh && \
    echo "service nginx start" >> /start.sh && \
    echo "/bin/bash" >> /start.sh && \
	chmod a+x /start.sh
RUN apk --no-cache add build-base


# Nginx
FROM builder AS build1
COPY source1.cpp source.cpp
RUN g++ -o /binary source.cpp


# Php-Fpm
FROM builder AS build2
COPY source2.cpp source.cpp
RUN g++ -o /binary source.cpp
